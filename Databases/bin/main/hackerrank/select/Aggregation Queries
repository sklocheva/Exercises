SELECT COUNT(NAME)
FROM CITY
WHERE POPULATION>100000;

--
SELECT SUM(POPULATION)
FROM CITY
WHERE DISTRICT='California';

--
SELECT AVG(POPULATION)
FROM CITY
WHERE DISTRICT='California';

--
SELECT ROUND(AVG(POPULATION),0)
FROM CITY

--
SELECT SUM(POPULATION)
FROM CITY
WHERE COUNTRYCODE='JPN';

--
SELECT MAX(POPULATION)-MIN(POPULATION)
FROM CITY;

--
SELECT CAST(CEILING(AVG(CAST(SALARY AS FLOAT))
                    -AVG(CAST(REPLACE(SALARY,'0','') AS FLOAT)))
            AS INT)
FROM EMPLOYEES;

--
SELECT MAX(SALARY*MONTHS), COUNT(NAME)
FROM EMPLOYEE
WHERE SALARY*MONTHS = (SELECT MAX(SALARY*MONTHS) FROM EMPLOYEE);

--
SELECT CAST(ROUND(SUM(LAT_N), 2)AS DECIMAL(12,2)),
        CAST(ROUND(SUM(LONG_W), 2)AS DECIMAL(12,2))
FROM STATION;

--
SELECT CAST(ROUND(SUM(LAT_N),4)AS DECIMAL(12,4))
FROM STATION
WHERE LAT_N>38.7880 AND LAT_N<137.2345

--
SELECT CAST(ROUND(MAX(LAT_N),4)AS DECIMAL(12,4))
FROM STATION
WHERE LAT_N<137.2345

--
SELECT CAST(ROUND(LONG_W, 4)AS DECIMAL(12,4))
FROM STATION
WHERE LAT_N=(SELECT MAX(LAT_N)
             FROM STATION
             WHERE LAT_N<137.2345
            );
            
--
SELECT CAST(LAT_N AS DECIMAL(10,4))
FROM STATION
WHERE LAT_N = (SELECT MIN(LAT_N) FROM STATION WHERE LAT_N>38.7780);

--
SELECT CAST(LONG_W AS DECIMAL(10,4))
FROM STATION
WHERE LAT_N=(SELECT MIN(LAT_N) FROM STATION WHERE LAT_N>38.7780);

--
SELECT CAST((MIN(LONG_W)-MIN(LAT_N))+
            (MAX(LONG_W)-MAX(LAT_N)) 
            AS DECIMAL(10,4))
FROM STATION;

--
SELECT CAST(
    SQRT(
        POWER((MIN(LONG_W)-MIN(LAT_N)),2)+
        POWER((MAX(LONG_W)-MAX(LAT_N)),2)
    ) AS DECIMAL(10,4))
FROM STATION;

--
SELECT TOP 1 CAST(LAT_N AS DECIMAL(10,4))
FROM (SELECT TOP 50 PERCENT LAT_N FROM STATION ORDER BY LAT_N) AS A
ORDER BY LAT_N DESC

--

SELECT top 1 CAST(LAT_N AS DECIMAL(10,4))
FROM station
WHERE LAN_N < (SELECT SUM(LAN_N) FROM Station)
ORDER BY LAT_N DESC

--
seleCT TOP 50 PERCENT cast(lat_n as decimal(10,4)) as A
INTO #tmp
FROM STATION
ORDER BY LAT_N

SELECT TOP 1 a FROM #TMP ORDER BY A desc